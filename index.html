<!doctype html>
<html lang="en">

<head>
   <meta charset="utf-8">

   <title>Mmmm... Google Guava</title>

   <meta name="description"
         content="A quick intro into Google's Guava library, best described as the ultimate Java-Painkiller ;-)">
   <meta name="author" content="Konrad Malawski">

   <meta name="apple-mobile-web-app-capable" content="yes"/>
   <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>

   <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet'
         type='text/css'>

   <link rel="stylesheet" href="css/reset.css">
   <link rel="stylesheet" href="css/main.css">
   <link rel="stylesheet" href="css/custom.css">
   <link rel="stylesheet" href="css/print.css" type="text/css" media="print">

   <link rel="stylesheet" href="lib/zenburn.css">
</head>

<body>

<div class="reveal">
   <div class="state-background"></div>

   <div class="slides">
      <section>
         <h1>
            Mmmm... <br/> Google Guava
            <img src="assets/images/guava.png" alt="guava"/>
         </h1>
         <script>
            // Delicously hacky. Look away.
            if (navigator.userAgent.match(/(iPhone|iPad|iPod|Android)/i)) document.write('<p style="color: rgba(0,0,0,0.3); text-shadow: none;">(' + 'Tap to navigate' + ')</p>');
         </script>
      </section>

      <section>
         <h2>About me</h2>

         <p>
            <img src="./assets/images/about_me.png" alt="about me" style="background: white;"/>
         </p>
      </section>

      <section>
         <h2>Guava is...</h2>

         <ul>
            <li class="fragment">a set of <strong>utility</strong> classes and methods</li>
            <li class="fragment">some quite neat <strong>collection</strong> implementations (AKA. google-collections)
            </li>
            <li class="fragment">comparable to <em>Apache Commons</em></li>
            <li class="fragment">basically... a <em><strong>painkiller</strong></em> and <em><strong>extension</strong></em> for Java (stdlib)</li>
         </ul>
      </section>

      <section>
         <h2>
            <br>
            <br>
            <br>
            Let's <b>go</b>!
         </h2>
      </section>

      <section>
         <section>
            <h2>Transform: GTUG -&gt; GDG</h2>

            Each <br>

            <img src="assets/images/gtug_krakow.png" alt="kraków gtug"> Member
            <br>
            <br>

            is now a:

            <br>

            <img src="assets/images/gdg_krakow_lq.png" alt="GDG Kraków"> Member
         </section>
         <section>
            <h2>Vanilla Java</h2>

               <pre><code contenteditable class="java">
List&lt;GTUGMember&gt; gtugMembers = new ArrayList &lt;GTUGMember&gt;();
gtugMembers.add(GTUG.member("Konrad"));
gtugMembers.add(GTUG.member("Łukasz"));

List&lt;GDGMember&gt; gdgMembers = new ArrayList &lt;&gt;();

for(GTUGMember member: gtugMembers)
gdgMembers.add(GDGMember.from(member))

// done!

               </code></pre>
         </section>

         <section>
            <h2>Transform</h2>

         <pre><code contenteditable class="java">import com.google.common.collect.*;

List&lt;GTUGMember&gt; gtugMembers = Lists.newArrayList(GTUG.member("Konrad"), GTUG.member("Łukasz"));

Function&lt;GTUGMember, GDGMember&gt; toGDGMember = new Function&lt;GTUGMember, GDGMember&gt;() {
  @Override
  public Object apply(@Nullable String input) {
    return input.toUpperCase();
  }
};

List&lt;GDGMember&gt; gdgMembers = Lists.transform(gtugMembers, toGDGMember);

         </code></pre>
         </section>

         <section>
            <h2>Transform</h2>

            A small trick:

               <pre><code contenteditable class="java">import com.google.common.collect.*;

class DGDMember {
  public static Function&lt;GTUGMember, GDGMember&gt; fromGTUGMember() { /* ... */ }
}

List&lt;GTUGMember&gt; gtugMembers = Lists.newArrayList(GTUG.member("Konrad"), GTUG.member("Łukasz"));

List&lt;GDGMember&gt; gdgMembers = Lists.transform(gtugMembers, GDGMember.fromGTUGMember());

               </code></pre>
         </section>

         <section>
            <h2 style="font-size: 1.5em">"This would be 1 line in _____"</h2>

            Scala for example:

            <pre><code contenteditable class="scala">
case class GTUGMember(val name: String)
case class GDGMember(val name: String)

val gtugMembers = List(GTUGMember("Konrad"))

// map all members to gdg Members
val gdgMembers = members map { GDGMember(_.name) }
            </code></pre>

            So, yes - we're aware such things are Simple in other languages, but that's where Guava tries to help.

            <br>
            <br>
            <div class="fragment">
               And anyway... <b>LISP</b> had those for years ;-)
            </div>
         </section>
      </section>



      <section>
         <section>
            <h2>Functional concepts brought to Java</h2>
            Many things in Guava are inspired by <strong>functional</strong> concepts from <em>other programming lanugages</em>,
            just like the previous "map operation" (<b>.transform()</b>)!
         </section>

         <section>
            <h2>Core concepts</h2>
            Some of the key functional concepts Guava uses are:

            <ul>
               <li class="fragment">Function&lt;A,B&gt; == <span class="code">A =&gt; B</span></li>
               <li class="fragment">Predicate&lt;T&gt; == <span class="code">T =&gt; Boolean</span></li>
               <li class="fragment">Optional&lt;T&gt; == "<span class="code">Present</span>" or "<span class="code">Absent</span>"</li>
            </ul>

            <br>
            <br>
            <div class="fragment"><span class="code">Optional</span> may seem similiar to a "<span class="code">Maybe Monad</span>" :-)</div>

         </section>

         <section>
            <h2>Function &lt;A,B&gt;</h2>
            Java7 doesn't have lambda expressions, but Guava helps us out (a bit) with <b>Function</b>.

            Composing functions:

            <pre><code class="java">
Function &lt;Integer, Integer&gt; doubler = new Function &lt;Integer, Integer&gt;() {
  @Override
  public Integer apply(@Nullable Integer input) {
    return input * 2;
  }
};

Function&lt;Integer, Integer&gt; halfer = new Function&lt;Integer, Integer&gt;() {
  @Override
  public Integer apply(@Nullable Integer input) {
    return input / 2;
  }
};

Function&lt;Integer, Integer&gt; identity = Functions.compose(doubler, halfer);

Integer two = identity.apply(2);
assertThat(two).isEqualTo(2);</code></pre>

            <span class="code fragment">doubler(halfer(x))</span>
         </section>

         <section>
            <h2>Optional vs. <span class="code">null</span></h2>

            <blockquote class="fragment" cite="http://code.google.com/p/guava-libraries/wiki/UsingAndAvoidingNullExplained">
               Null Sucks.
               -- Doug Lea
            </blockquote>

            <br>
            <br>
            <div class="fragment">
               <span class="code">null </span> is "<em>hidden</em>",<br>
               <span class="code">Optional</span> is <b>explicit</b>.
            </div>

         </section>

         <section>
            <h2>Optional</h2>

            <div class="">
               Ugly but <span class="code">null</span>-safe:
               <pre><code class="java">
public String fullName(String firstName,
                       Optional&lt;String&gt; maybeMiddleName,
                       String lastName) {

  String middleName = "";
  if(maybeMiddleName.isPresent()) {middleName = maybeMiddleName.get();}
  return firstName + " " + middleName + " " + lastName;
}</code></pre>
            </div>

            <div class="fragment">
               Nicer:
               <pre><code class="java">
public String fullName(String firstName,
                       Optional&lt;String&gt; maybeMiddleName,
                       String lastName) {

  return firstName + " " + maybeMiddleName.or("") + " " + lastName;
}
</code></pre>
            </div>

            <blockquote class="fragment">
               Haven't seen a null-pointer in my code since a few months now! -- random Optional user
            </blockquote>

         </section>

         <section>
            <h2>Predicate</h2>
            Quite similar to Function but does <em>NOT</em> extend it.

            <pre><code class="java">Predicate&lt;User&gt; onlyAwesome = new Predicate&lt;User&gt;() {
  @Override
  public boolean apply(@Nullable User in) {
    return Optional.fromNullable(in).or(User.NOT_AWESOME).isAwesome();
  }
}</code></pre>

            <div class="fragment">
               Let's use it on a collection:

               <pre><code class="java">List&lt;User&gt; users = getMixedUsers();
// find all awesome users
List&lt;User&gt; onlyAwesomeUsers = Iterables.filter(users, onlyAwesome);
</code></pre>

               <pre class="fragment"><code class="java">// find one (first) awesome user
User awesomeUser = Iterables.find(users, onlyAwesome);
// or better:
Optional&lt;User&gt; awesomeOrAbsent = Iterables.tryFind(users, onlyAwesome);</code></pre>
            </div>
         </section>

         <section>
            <h2>Iterables.*</h2>
            Iterables has a lot useful static methods:

            <ul>
               <li class="code fragment">&lt;T&gt; T get(Iterable&lt;? extends T&gt; iterable, int position, T defaultValue) </li>
               <li class="code fragment">&lt;T&gt; Iterable &lt;List&lt;T&gt;&gt; partition(Iterable&lt;T&gt; iterable, int size) </li>
               <li class="code fragment">&lt;T&gt; boolean all(Iterable&lt;T&gt; iterable, Predicate&lt;? super T&gt;  predicate) </li>
               <li class="code fragment">&lt;T&gt; boolean any(Iterable&lt;T&gt; iterable, Predicate&lt;? super T&gt;  predicate) </li>
               <li class="code fragment">&lt;T&gt; Iterable&lt;T&gt; cycle(&lt;T&gt;... elements)</li>
               <li class="fragment">and a lot more!</li>
            </ul>

         </section>

         <section>
            <h2>Pro Tip: Function.forMap()</h2>

            In Scala for example, a Map behaves just like a Function:
            <pre><code class="scala" contenteditable>val nicknameOf = Map("Konrad" -> "ktoso")
nicknameOf("Konrad") == "ktoso"</code></pre>

            <div class="fragment">
               With Guava's help you can do the same:

                           <pre><code class="java" contenteditable>ImmutableMap &lt;String, String&gt; nicknameMap = ImmutableMap.of("Konrad", "ktoso");
Function &lt;String, String&gt; nicknameOf = Functions.forMap(nicknameMap);

nicknameOf.apply("Konrad");</code></pre>


            If you think about it, a Map is just a function with a <abbr title="Look Up Table">LUT</abbr>.
            </div>

            <br>
            <div class="fragment">"Hey, what's this <b>ImmutableMap</b>?!"</div>
         </section>
      </section>

      <section>
         <section>
            <h2>Immutability</h2>

            Is <strong>awesome</strong> because:
            <ul>
               <li>
                  free <strong>thread safety</strong>
               </li>
               <li>
                  No more "will someone change this collection?" panic
               </li>
               <li>
                  sometimes -&gt; <em>performance</em>
               </li>
            </ul>
         </section>
         <section>
            <h2>Vanilla JDK - constant set</h2>
            <pre><code contenteditable class="java">
               public static final Set&lt;Integer&gt; NUMS = Collections.unmodifiableSet(
                 new LinkedHashSet&lt;&gt;(
                   Arrays.asList(1, 2, 3, 4, 5, 6)
                 )
               );
            </code></pre>

            Problems here?

            <ul>
               <li class="fragment">3 external classes to build a Set?!</li>
               <li class="fragment">Not here but in general: <strong>Umodifiable != Immutable</strong>!</li>
            </ul>
         </section>

         <section>
            <h2>ImmutableSet</h2>

            <pre><code class="java" contenteditable>
              public static final Set&lt;Integer&gt; NUMS = ImmutableSet.of(1, 2, 3, 4, 5);
            </code></pre>

            <div>
               <div>Better now?</div>

                           <ul>
                              <li class="fragment">Guaranteed immutability</li>
                              <li class="fragment">FAST</li>
                              <li class="fragment">SMALL</li>
                           </ul>
            </div>

         <span class="fragment">
            <small>Highly recommended to check out it's sources - lot's of smart optimizations down there!</small>
         </span>
         </section>

         <section>
            <h2>Defensive copying</h2>

            <pre><code class="java"contenteditable>
               public static final ImmutableSet &lt;Color&gt; GOOGLE_COLORS =
                 ImmutableSet.&lt;Color&gt;builder()
                   .addAll(WEBSAFE_COLORS)
                   .add(new Color(0, 191, 255))
                   .build();
            </code></pre>
         </section>

         <section>
            <h2>More immutable collections</h2>
            <small>
            <ul>
               <li>DescendingImmutableSortedMultiset.java         </li>
               <li>ForwardingImmutableList.java                   </li>
               <li>ForwardingImmutableMap.java                    </li>
               <li>ForwardingImmutableSet.java                    </li>
               <li>ImmutableAsList.java                           </li>
               <li>ImmutableBiMap.java                            </li>
               <li>ImmutableClassToInstanceMap.java               </li>
               <li>ImmutableCollection.java                       </li>
               <li>ImmutableEntry.java                            </li>
               <li>ImmutableEnumSet.java                          </li>
               <li>ImmutableList.java                             </li>
               <li>ImmutableListMultimap.java                     </li>
               <li>ImmutableMap.java                              </li>
               <li>ImmutableMultimap.java                         </li>
               <li>ImmutableMultiset.java                         </li>
               <li>ImmutableSet.java                              </li>
               <li>ImmutableSetMultimap.java                      </li>
               <li>ImmutableSortedAsList.java                     </li>
               <li>ImmutableSortedMap.java                        </li>
               <li>ImmutableSortedMapFauxverideShim.java          </li>
               <li>ImmutableSortedMultiset.java                   </li>
               <li>ImmutableSortedMultisetFauxverideShim.java     </li>
               <li>ImmutableSortedSet.java                        </li>
               <li>ImmutableSortedSetFauxverideShim.java          </li>
               <li>ImmutableTable.java                            </li>
               <li>SingletonImmutableTable.java                   </li>
               <li>TransformedImmutableSet.java                   </li>
               <li>... and a lot more ;-)</li>
            </ul>
            </small>
         </section>
      </section>

      <section>
         <section>
            <h2>More Collection utils</h2>

            A pair of:
            <ul>
               <li>Joiner</li>
               <li>Splitter</li>
            </ul>
         </section>

         <section>
            <h2>Joiner</h2>

         </section>
      </section>

      <section>
         <section>
            <h2>Streams &amp; Files</h2>

            IO Operations are a bit bloated in java (6):

            <pre class="fragment"><code class="java"> try {
  FileWriter fstream = new FileWriter("out.txt");
  BufferedWriter out = new BufferedWriter(fstream);
  out.write("Hello Java");
  out.close();
} catch (Exception ex) {
  logger.error("Unable to hello world! AAAA!", ex);
} finally {
  try {
    if(out != null) out.close();
  } catch(Exception ex) {
    logger.error("Unable to close writer! AAAA!!", ex);
  }
}
</code></pre>

            <div class="fragment">
               It's gotten better with <b>Java 7</b>'s try-with-resources:

               <pre><code class="java">try(BufferedWriter out = new BufferedWriter(new FileWriter("out.txt"))) {
  out.write("Hello Java 7!");
}</code></pre>
            </div>
         </section>

         <section>
            <h2>Files</h2>
            Guava on the other hand contains such nice methods as:

            <pre><code class="java">Files.write("Hello Guava!", new File(""), Charsets.UTF_8);

Files.append("Hello Guava!", new File(""), Charsets.UTF_8);
            </code></pre>

         <div class="fragment">
            We also get some File operation utils (which are kind-of replaced by Java 7's <span class="code"><a
               href="http://www.java7developer.com/blog/?p=334">Paths</a></span> nowadays):

            <pre><code class="java">Files.move(fromFile, toFile);
Files.touch(new File("/tmp/it.txt"));

// and others:
Files.toString(file, Charsets.UTF_16);
Files.equal(someFile, anotherFile);
            </code></pre>

         </div>
         </section>

         <section>
            <h2>Closeables</h2>

            Yet another way to close streams:

            <pre><code class="java">public void useStreamNicely() throws IOException {
  SomeStream stream = new SomeStream("foo");
  boolean threw = true;
  try {
    // Some code which does something with the Stream. May throw a
    // Throwable.
    threw = false; // No throwable thrown.
  } finally {
    // Close the stream.
    // If an exception occurs, only rethrow it if (threw==false).
    Closeables.close(stream, threw);
}
            </code></pre>
         </section>

         <!--<section>-->
            <!--<h2>Resources</h2>-->
            <!--A nice utility class for dealing with... Resources ;-)-->

            <!--<div class="fragment">-->
               <!--Shortest possible GET request in Java:-->
               <!--<pre><code class="java">String myIp = Resources.toString(new URL("http://ip.appspot.com"), Charsets.UTF_8);-->
<!--System.out.println(myIp)</code></pre>-->

               <!--Although it's primarily targeted at Classpath Resources ;-)-->

               <!--<pre><code class="java">-->
                  <!--URL resourceUrl = Resources.getResource("config.properties");-->
                  <!---->
               <!--</code></pre>-->
            <!--</div>-->
         <!--</section>-->
      </section>

      <section>
         <h2>I want moar!</h2>

         <div>
            Sources: <br>
            <ul>
               <li>
                  <a href="http://code.google.com/p/guava-libraries/">
                     http://code.google.com/p/guava-libraries/
                  </a>
               </li>
            </ul>
         </div>
         <br>

         <div>Presentations: <br>
            <ul>
               <li>
                  <a href="http://tomaszdziurko.pl/tag/guava/">Tomek Dziurko about Guava</a>
               </li>
            </ul>
         </div>

         <br>

         <div>
            Videos: <br>
            <ul>
               <li>
                  <a href="http://www.youtube.com/watch?v=0XUBugyOhh8">
                     TravelChannel about Guavas from Hawaii
                  </a>
               </li>
               <li>
                  <a href="http://www.youtube.com/watch?v=ZeO_J2OcHYM">
                     Google Collections (Kevin Bourrillion &amp; Joshua Bloch)
                     <img src="assets/images/plus.png" alt="plus"/>
                  </a>
               </li>
            </ul>
         </div>
      </section>

      <section>
         <h1>ありがとう！</h1>

         <h2>Dzięki!</h2>

         <div class="inverted right">
            slides are googlable <br/>
            or @ <a href="http://www.blog.project13.pl">blog.project13.pl</a>
         </div>
      </section>
   </div>


   <!-- EOP -->


   <!-- The navigational controls UI -->
   <aside class="controls">
      <a class="left" href="#">&#x25C4;</a>
      <a class="right" href="#">&#x25BA;</a>
      <a class="up" href="#">&#x25B2;</a>
      <a class="down" href="#">&#x25BC;</a>
   </aside>

   <!-- Displays presentation progress, max value changes via JS to reflect # of slides -->
   <div class="progress"><span></span></div>

</div>

<!-- Optional libraries for code syntax highlighting and classList support in IE9 -->
<script src="lib/highlight.js"></script>
<script src="lib/classList.js"></script>

<script src="js/reveal.js"></script>

<script>
   // Parse the query string into a key/value object
   var query = {};
   location.search.replace(/[A-Z0-9]+?=(\w*)/gi, function (a)
   {
      query[ a.split('=').shift() ] = a.split('=').pop();
   });

   // Fires when a slide with data-state=customevent is activated
   Reveal.addEventListener('customevent', function ()
   {
      alert('"customevent" has fired');
   });

   // Fires each time a new slide is activated
   Reveal.addEventListener('slidechanged', function (event)
   {
      // event.previousSlide, event.currentSlide, event.indexh, event.indexv
   });

   Reveal.initialize({
      // Display controls in the bottom right corner
      controls:true,

      // Display a presentation progress bar
      progress:true,

      // If true; each slide will be pushed to the browser history
      history:true,

      // Loops the presentation, defaults to false
      loop:false,

      // Flags if mouse wheel navigation should be enabled
      mouseWheel:true,

      // Apply a 3D roll to links on hover
      rollingLinks:true,

      // UI style
      theme:query.theme || 'default', // default/neon

      // Transition style
      transition:query.transition || 'default' // default/cube/page/concave/linear(2d)
   });

   hljs.initHighlightingOnLoad();
</script>

</body>
</html>
